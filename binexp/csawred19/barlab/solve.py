from pwn import *

#p = process("./output", aslr=False)
p = remote("rev.chal.csaw.io", 1005)

a = [0x1d, 0x1f, 0x59, 0x15, 2, 0x54, 0x1a, 8, 0x43, 3, 3, 0x19, 0xe, 0x57, 0xd, 0x5c, 0xc, 0x74, 2, 0x5c, 6, 1, 0x46]
b = [0x69, 0x6d, 0x68, 0x65, 0x72, 0x65, 0x74, 0x6f, 0x73, 0x65, 0x65, 0x6d, 0x66, 0x64, 0x6f, 0x6f, 0x6d, 0x00]
print(len(a))
print(len(b))

ret = ""
for i in range(len(a)):
  ret += (chr(b[i % 0x12] ^ a[i]))
p.sendline(ret)
print(ret)

c = [0x69, 0x34, 0x64, 0x31, 0x56, 0x70, 0x66, 0x4a, 0x6e, 0x68, 0x72, 0x66, 0x33, 0x5c, 0x34, 0x67, 0x56, 0x34, 0x6e, 0x54, 0x72, 0x72, 0x74, 0x64]

ret2 = ""
for i in range(0, len(c), 3):
  ret2 += chr(c[i+2])

  for j in range(256):
    if (j * c[i+2]) % 0x4a + ord("0") == c[i+1]:
      print(j)
      ret2 += chr(j)
      break

  ret2 += chr(c[i])

p.sendline(ret2)
print(ret2)

p.interactive()
